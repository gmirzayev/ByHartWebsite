---
import "../styles/utils.css";
import Image from "astro/components/Image.astro";
import VideoLoop from "./VideoLoop.astro";

import Ample from "../assets/Home/img/Ample.png";
import ComicsKingdomVideo from "../assets/Home/Comics_Kingdom.mp4";
import Wizehire from "../assets/Home/Wizehire.gif";
import WeekAndVideo from "../assets/Home/WeekAnd.mp4";
import DancePartyTime from "../assets/Home/img/Dance_Party_Time.png";
import MetroVeinVideo from "../assets/Home/Metro_Vein.mp4";
import Lockwood from "../assets/Home/img/Lockwood.png";
import PuzzlePalace from "../assets/Home/img/Puzzle_Palace.png";
import Sage from "../assets/Home/img/Sage.png";
import SixFeet from "../assets/Home/img/6_Feet_Apart.png";
import BluprintVideo from "../assets/Home/Bluprint.mp4";
import DiscoveryVideo from "../assets/Home/Discovery.mp4";
import FabVideo from "../assets/Home/Fab.mp4";
import GeniusKitchen from "../assets/Home/img/Genius_Kitchen.png";
import Horowitz from "../assets/Home/img/Horowitz_Real_Estate.png";
import Kindra from "../assets/Home/Kindra.gif";
import Magnolia from "../assets/Home/img/Magnolia.png";
import Nightingale from "../assets/Home/img/Nightingale.png";
import PearlyBites from "../assets/Home/img/Pearly_Bites.png";
import TheCurve from "../assets/Home/img/The_Curve.png";
import SayMore from "../assets/Home/img/Say_More.png";
import Archive from "../assets/Home/img/Archive.png";
import Firefly from "../assets/Home/img/Firefly.png";
import PetCenterVideo from "../assets/Home/PetDermatologyCenter.mp4";
import HGTV2Video from "../assets/Home/HGTV_2.mp4";
import Photography from "../assets/Home/img/Photography.png";
import PresentationsAlt from "../assets/Home/img/Presentations_ALT.png";
import SarahVideo from "../assets/Home/img/Sarah_Video.png";
import WordOnly from "../assets/Home/img/Word_Only.png";
import Reach from "../assets/Home/img/Reach.png";
import ApartmentTherapy from "../assets/Home/img/Apartment_Therapy.png";
import Illustration from "../assets/Home/Illustration.gif";

const projects = [
  {
    slug: "wizehire",
    title: "Wizehire",
    gif: Wizehire,
    alt: "Pizzas being prepared for baking centered in a cutout in the shape of the side portrait of a person's head.",
  },
  {
    slug: "lockwood",
    title: "Lockwood",
    img: Lockwood,
    alt: "Entrace to an office with a couch, front desk, and a man walking away from the camera.",
  },
  {
    slug: "week-and",
    title: "Week&",
    vid: WeekAndVideo,
    alt: " ",
  },
  {
    slug: "pearly-bites",
    title: "Pearly Bites",
    img: PearlyBites,
    alt: " ",
  },
  {
    slug: "discovery",
    title: "Discovery",
    vid: DiscoveryVideo,
    alt: " ",
  },
  {
    slug: "magnolia",
    title: "Magnolia",
    img: Magnolia,
    alt: " ",
  },
  {
    slug: "genius-kitchen",
    title: "Genius Kitchen",
    img: GeniusKitchen,
    alt: " ",
  },
  {
    slug: "illustration",
    title: "Custom Illustrations",
    gif: Illustration,
    alt: " ",
    comingSoon: true,
  },
  {
    slug: "presentations",
    title: "Presentation Magic",
    img: PresentationsAlt,
    alt: " ",
    comingSoon: true,
  },
  {
    slug: "ample",
    title: "Ample",
    img: Ample,
    alt: "Entrace to an office with a couch, front desk, and a man walking away from the camera.",
  },
  {
    slug: "metro-vein-centers",
    title: "Metro Vein Centers",
    vid: MetroVeinVideo,
    alt: "Pizza being made through a cutout in the shape of a face on a purple rectangle.",
  },
  {
    slug: "puzzle-palace",
    title: "Puzzle Palace",
    img: PuzzlePalace,
    alt: " ",
  },
  {
    slug: "nightingale",
    title: "Nightingale Vets",
    img: Nightingale,
    alt: " ",
  },
  {
    slug: "fab",
    title: "Fab",
    vid: FabVideo,
    alt: " ",
  },
  {
    slug: "say-more",
    title: "Say More",
    img: SayMore,
    alt: " ",
  },
  {
    slug: "six-feet",
    title: "6 Feet Apart",
    img: SixFeet,
    alt: " ",
  },
  {
    slug: "bluprint",
    title: "Bluprint",
    vid: BluprintVideo,
    alt: " ",
  },
  {
    slug: "apartment-therapy",
    title: "Apartment Therapy",
    img: ApartmentTherapy,
    alt: " ",
  },
  {
    slug: "photography",
    title: "Photography Direction",
    img: Photography,
    alt: " ",
    comingSoon: true,
  },
  {
    slug: "top-secret-archive",
    title: "Top Secret Archive",
    img: Archive,
    alt: " ",
    comingSoon: true,
  },
  {
    slug: "comics-kingdom",
    title: "Comics Kingdom",
    vid: ComicsKingdomVideo,
    alt: "Two speech bubbles turned vertically and having eyes so they look like faces.",
  },
  {
    slug: "sage",
    title: "Sage",
    img: Sage,
    alt: " ",
  },
  {
    slug: "dance-party-time",
    title: "Dance Party Time",
    img: DancePartyTime,
    alt: "A clock with eyes and a mouth on stripes of different colors.",
    comingSoon: true,
  },
  {
    slug: "kindra",
    title: "Kindra",
    gif: Kindra,
    alt: "Two pills on various illustrations.",
  },
  {
    slug: "curve-report",
    title: "The Curve Report",
    img: TheCurve,
    alt: "A woman sits on a desk with her laptop in her lap looking down at a child on the floor that pulls at her dress.",
  },
  {
    slug: "horowitz-real-estate",
    title: "Horowitz",
    img: Horowitz,
    alt: "An illustrated map that focuses on Astoria, NYC.",
    comingSoon: true,
  },
  {
    slug: "pet-dermatology-center",
    title: "Pet Dermatology",
    vid: PetCenterVideo,
    alt: "",
  },
  {
    slug: "firefly-vets",
    title: "Firefly Vets",
    img: Firefly,
    alt: "The hind leg and tail of a dog laying on a bed.",
  },
  {
    slug: "hgtv",
    title: "HGTV",
    vid: HGTV2Video,
    alt: "",
    comingSoon: true,
  },
  {
    slug: "nbcu-reach-redefined",
    title: "NBCU Reach Redefined",
    img: Reach,
    alt: "Shots of a camera's monitor as a show is filmed.",
  },
  {
    slug: "in-words-only",
    title: "In Words Only",
    img: WordOnly,
    alt: "Everyone deserves a healthy head of hair on a wall in an office.",
    comingSoon: true,
  },
  {
    slug: "see-sarah-dance",
    title: "See Sarah Dance",
    img: SarahVideo,
    alt: "A behind the scenes photo of a rehearsal.",
  },
];

// Ordering for two-column layout
let narrow_layout = [
  [
    "wizehire",
    "lockwood",
    "sage",
    "dance-party-time",
    "kindra",
    "pearly-bites",
    "say-more",
    "horowitz-real-estate",
    "six-feet",
    "pet-dermatology-center",
    "bluprint",
    "apartment-therapy",
    "illustration",
    "nbcu-reach-redefined",
    "top-secret-archive",
    "in-words-only",
  ],
  [
    "ample",
    "comics-kingdom",
    "metro-vein-centers",
    "puzzle-palace",
    "week-and",
    "nightingale",
    "fab",
    "curve-report",
    "discovery",
    "magnolia",
    "genius-kitchen",
    "firefly-vets",
    "hgtv",
    "photography",
    "presentations",
    "see-sarah-dance",
  ],
];

// Ordering for three-column layout
let wide_layout = [
  [
    "wizehire",
    "lockwood",
    "week-and",
    "pearly-bites",
    "discovery",
    "magnolia",
    "genius-kitchen",
    "illustration",
    "presentations",
  ],
  [
    "ample",
    "metro-vein-centers",
    "puzzle-palace",
    "nightingale",
    "fab",
    "say-more",
    "six-feet",
    "bluprint",
    "apartment-therapy",
    "photography",
    "top-secret-archive",
  ],
  [
    "comics-kingdom",
    "sage",
    "dance-party-time",
    "kindra",
    "curve-report",
    "horowitz-real-estate",
    "pet-dermatology-center",
    "firefly-vets",
    "hgtv",
    "nbcu-reach-redefined",
    "in-words-only",
    "see-sarah-dance",
  ],
];

function getProject(slug) {
  const project = projects.find((p) => p.slug == slug);
  if (!project) throw new Error(`Unknown project slug: ${slug}`);
  return project;
}

// vary the tooltip angles for each grid cell
let counter = 0;
let stepCount = 4;
---

<div id="portfolio" class="works-grid">
  <div class="wide">
    {
      wide_layout.map((slugs) => (
        <div class="column">
          {slugs.map((slug) => {
            let { title, img, gif, vid, alt, comingSoon } = getProject(slug);
            if (comingSoon) title += " — Coming Soon";
            let page = comingSoon ? null : `/works/${slug}`;
            return (
              <div class:list={["project", `step-${counter++ % stepCount}`]}>
                <a href={page} data-title={title}>
                  {img && <Image src={img} width={1000} alt={alt} />}
                  {gif && <img src={gif.src} alt={alt} />}
                  {vid && <VideoLoop src={vid} />}
                  <h2>{title}</h2>
                </a>
              </div>
            );
          })}
        </div>
      ))
    }
  </div>

  <div class="narrow">
    {
      narrow_layout.map((slugs) => (
        <div class="column">
          {slugs.map((slug) => {
            let { title, img, gif, vid, alt, comingSoon } = getProject(slug);
            if (comingSoon) title += " — Coming Soon";
            return (
              <div class:list={["project", `step-${counter++ % stepCount}`]}>
                <a href={`/works/${slug}`} data-title={title}>
                  {img && <Image src={img} width={1000} alt={alt} />}
                  {gif && <img src={gif.src} alt={alt} />}
                  {vid && <VideoLoop src={vid} />}
                  <h2>{title}</h2>
                </a>
              </div>
            );
          })}
        </div>
      ))
    }
  </div>
</div>

<style is:global>
  .works-grid {
    padding: 0 25px;

    @media (min-width: 768px) {
      padding: 0 40px;
    }
  }

  .works-grid .project {
    position: relative;
    margin-bottom: 28px;

    img,
    video {
      width: 100%;
      border-radius: 6px;
      margin-bottom: 10px;
    }

    h2 {
      font:
        400 14px/1 "utile-display",
        sans-serif;
      letter-spacing: 0.05em;
      color: var(--cream);
    }

    a::after {
      content: attr(data-title);
      position: absolute;
      left: 50%;
      top: 50%;
      padding: 0 30px;
      height: 38px;
      border-radius: 35px;
      color: black;
      font:
        14px/2.7 "Karla",
        sans-serif;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      background-color: var(--peach);
      text-align: center;
      white-space: nowrap;
      pointer-events: none;
      box-shadow: 0 0 40px rgba(0, 0, 0, 50%);

      display: none;

      opacity: 0;
      transform: translate(-50%, -50%) rotate(16deg);
      transform-origin: top left;
      transition:
        opacity 333ms,
        transform 333ms;
      z-index: 1;
    }

    a:hover::after {
      opacity: 1;
      transform: translate(-48%, -50%) rotate(8deg);
    }

    &.step-1 {
      a::after {
        transform-origin: bottom left;
        transform: translate(-50%, -50%) rotate(-16deg);
      }
      a:hover::after {
        transform: translate(-48%, -50%) rotate(-8deg);
      }
    }

    &.step-2 {
      a::after {
        transform-origin: bottom right;
        transform: translate(-30%, -50%) rotate(-5deg);
      }
      a:hover::after {
        transform: translate(-48%, -50%) rotate(17deg);
      }
    }

    &.step-3 {
      a::after {
        transform-origin: top left;
        transform: translate(-30%, -50%) rotate(5deg);
      }
      a:hover::after {
        transform: translate(-48%, -50%) rotate(-17deg);
      }
    }

    @media (min-width: 768px) {
      margin-bottom: 40px;
      h2 {
        display: none;
      }
      a::after {
        display: block;
      }
    }
  }

  .works-grid .narrow {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 25px;

    @media (min-width: 768px) {
      display: none;
    }
  }

  .works-grid .wide {
    display: none;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 40px;
    max-width: 1680px;
    margin: 0 auto;

    @media (min-width: 768px) {
      display: grid;
    }
  }
</style>

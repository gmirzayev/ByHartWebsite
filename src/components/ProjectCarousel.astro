---
import "../styles/utils.css";
const { name } = Astro.props;
import Image from "astro/components/Image.astro";
import Wizehire from "../assets/Home/Wizehire.png";
import Ample from "../assets/Home/Ample.png";
import ComicsKingdom from "../assets/Home/Comics_Kingdom.png";
import Week from "../assets/Home/Week.png";
import DancePartyTime from "../assets/Home/Dance_Party_Time.png";
import MetroVein from "../assets/Home/Metro_Vein.png";
import Lockwood from "../assets/Home/Lockwood.png";
import PuzzlePalace from "../assets/Home/Puzzle_Palace.png";
import Sage from "../assets/Home/Sage.png";
import SixFeet from "../assets/Home/6_Feet_Apart.png";
import Blueprint from "../assets/Home/Blueprint.png";
import Discovery from "../assets/Home/Discovery.png";
import Fab from "../assets/Home/Fab.png";
import GeniusKitchen from "../assets/Home/Genius_Kitchen.png";
import Horowitz from "../assets/Home/Horowitz_Real_Estate.png";
import Kindra from "../assets/Home/Kindra.png";
import Magnolia from "../assets/Home/Magnolia.png";
import Nightingale from "../assets/Home/Nightingale.png";
import PearlyBites from "../assets/Home/Pearly_Bites.png";
import TheCurve from "../assets/Home/The_Curve.png";
import SayMore from "../assets/Home/Say_More.png";
import Firefly from "../assets/Home/Firefly.png";
import PetCenter from "../assets/Home/Pet_Center.png";

const projects = [
  { name: "Wizehire", image: Wizehire },
  { name: "Ample", image: Ample },
  { name: "Comics Kingdom", image: ComicsKingdom },
  { name: "Lockwood", image: Lockwood },
  { name: "Metro Vein Centers", image: MetroVein },
  { name: "Sage", image: Sage },
  { name: "Puzzle Palace", image: PuzzlePalace },
  { name: "Dance Party Time", image: DancePartyTime },
  { name: "Week&", image: Week },
  { name: "Kindra", image: Kindra },
  { name: "Nightingale Vets", image: Nightingale },
  { name: "Pearly Bites", image: PearlyBites },
  { name: "Fab", image: Fab },
  { name: "The Curve Report", image: TheCurve },
  { name: "Say More", image: SayMore },
  { name: "Discovery Channel", image: Discovery },
  { name: "Horowitz Real Estate", image: Horowitz },
  { name: "Magnolia", image: Magnolia },
  { name: "6 Feet Apart", image: SixFeet },
  { name: "Pet Dermatology Center", image: PetCenter },
  { name: "Genius Kitchen", image: GeniusKitchen },
  { name: "Bluprint", image: Blueprint },
  { name: "Firefly Vets", image: Firefly },
];
---

<style>
  .container {
    display: flex;
    flex-direction: column;
    text-align: center;
    width: 100%;
    height: 750px;
    position: relative;
    max-width: none;
    background-color: #242121;
    color: #f7f4ed;
    font-family: "Karla";
  }

  #carousel-container {
    width: 100%;
    height: 550px;
    position: relative;
    overflow: hidden;
  }

  #carousel {
    display: flex;
    flex-direction: row;
    gap: 50px;
    position: absolute;
    /* pointer-events: none; */
    /* position: absolute; */
    /* top: 0;
    left: 0; */
    overflow: hidden;
    transition: transform 2s;
  }

  .font-utile {
    font-family: "utile-display", sans-serif;
  }

  /* .background-slant {
    content: "";
    display: block;
    position: absolute;
    margin-left: auto;
    margin-right: auto;
    left: 0;
    right: 0;
    width: 200px;
    height: 100px;
    z-index: 1;
    background-color: #ebd4c7;
  } */
</style>
<div class="container">
  <h1 class="text-[66px]">Choose your next adventure...</h1>
  <h3 class="mb-[20px]">DRAG TO EXPLORE</h3>
  <div id="carousel-container">
    <div id="carousel">
      {
        projects.map((project) => {
          if (name !== project.name) {
            return (
              <div class="item pointer-events-none">
                <Image
                  class="h-[500px] w-auto max-w-none rounded-md"
                  src={project.image}
                  alt="test"
                />
                <h1 class="h-[50px] mt-[10px] invisible font-utile font-medium tracking-wider text-xl">
                  {project.name}
                </h1>
              </div>
            );
          }
        })
      }
    </div>
  </div>
  <div class="background-slant"></div>
  <h1 class="h-[50px] text-xl background-slant">SEE ALL HART WORK</h1>
</div>
<script>
  // const carouselContainer = document.getElementById("carousel-container");
  const carousel = document.getElementById("carousel");
  let items = document.querySelectorAll(".item");
  let focusedItem = 5;
  let midPoint = window.innerWidth / 2;

  const moveToCenter = () => {
    let itemRect = items[focusedItem].getBoundingClientRect();
    let itemOffset = items[focusedItem].offsetLeft + itemRect.width / 2;
    carousel.style.cssText += `${"transform: translateX(" + -1 * (itemOffset - window.innerWidth / 2 + carousel.offsetLeft) + "px)"}`;
  };

  const switchLabel = (prevItem, newItem) => {
    console.log(prevItem);
    console.log(newItem);
    let prevLabel = prevItem.children[1];
    let newLabel = newItem.children[1];
    console.log(prevLabel);
    console.log(newLabel);
    if (prevLabel.tagName == "H1" && prevLabel.classList.contains("visible")) {
      prevLabel.classList.remove("visible");
      prevLabel.classList.add("invisible");
    }
    if (newLabel.tagName == "H1" && newLabel.classList.contains("invisible")) {
      newLabel.classList.remove("invisible");
      newLabel.classList.add("visible");
    }
  };

  switchLabel(items[0], items[5]);
  moveToCenter();

  carousel.addEventListener("mousemove", (event) => {
    if (event.buttons == 1) {
      // console.log(carousel.offsetLeft - event.movementX);
      event.preventDefault();
      // console.log(event.offsetX);
      // console.log(carousel.offsetLeft);
      carousel.style.left = `${carousel.offsetLeft - event.movementX * -1}px`;
      if (event.movementX > 0) {
        //going left
        let leftItemRect = items[focusedItem - 1].getBoundingClientRect();
        let leftItemMidpoint = leftItemRect.x + leftItemRect.width / 2;
        let leftItemHalfWidth = leftItemRect.width / 2;
        if (
          leftItemMidpoint > midPoint - leftItemHalfWidth &&
          leftItemMidpoint < midPoint + leftItemHalfWidth
        ) {
          switchLabel(items[focusedItem], items[focusedItem - 1]);
          focusedItem = focusedItem - 1;
        }
      } else {
        let rightItemRect = items[focusedItem + 1].getBoundingClientRect();
        let rightItemMidpoint = rightItemRect.x + rightItemRect.width / 2;
        let rightItemHalfWidth = rightItemRect.width / 2;
        if (
          rightItemMidpoint > midPoint - rightItemHalfWidth &&
          rightItemMidpoint < midPoint + rightItemHalfWidth
        ) {
          switchLabel(items[focusedItem], items[focusedItem + 1]);
          focusedItem = focusedItem + 1;
        }
      }
    }
  });

  carousel.addEventListener("mouseleave", (event) => {
    moveToCenter();
  });

  carousel.addEventListener("mouseup", (event) => {
    event.preventDefault();
    moveToCenter();
    // carousel.style.left =
  });

  for (let i = 0; i < items.length; i++) {
    items[i].addEventListener("mousedown", (event) => {
      console.log("hello");
      switchLabel(items[focusedItem], items[i]);
      focusedItem = i;
      moveToCenter();
    });
  }

  // const showName = () => {
  //   for (let item of items) {
  //     console.log(item.getBoundingClientRect());
  //     let itemRect = item.getBoundingClientRect();
  //     let itemMidpoint = itemRect.x + itemRect.width / 2;
  //     if (itemMidpoint > midPoint - 60 && itemMidpoint < midPoint + 60) {
  //       if (
  //         item.children[1].tagName == "H1" &&
  //       ) {
  //         item.children[1].classList.add("!visible");
  //         previousItem = item.children[1];
  //       }
  //     }
  //   }
  // };

  // showName();

  // carouselContainer.addEventListener("mousedown", (event) => {
  //   startX = event.offsetX - carousel.offsetLeft;
  //   console.log(startX);
  // });

  // carouselContainer.addEventListener("mouseup", (event) => {
  //   if (dragging) {
  //     dragging = false;
  //   }
  // });
</script>

<!-- 
//let carouselContainer = document.querySelector(".carousel-container");
//let carousel = document.querySelector(".carousel");
//let items = document.querySelectorAll(".item");
//let midPoint = window.innerWidth / 2;
//let previousItem;

// for (let item of items) {
//   let itemRect = item.getBoundingClientRect();
//   let itemMidpoint = itemRect.x + itemRect.width / 2;
//   if (itemMidpoint > midPoint - 60 && itemMidpoint < midPoint + 60) {
//     if (
//       item.children[1].tagName == "H1" &&
//       item.children[1].classList.contains("invisible")
//     ) {
//       item.children[1].classList.add("visible");
//       item.children[1].classList.remove("invisible");
//       previousItem = item.children[1];
//     }
//   }
// }

// let pressed = false;
// let startX;
// let x;

// middleRow.addEventListener("mousedown", (e) => {
//   pressed = true;
//   startX = e.offsetX - innerContainer.offsetLeft;
//   middleRow.style.cursor = "grabbing";
// });

// middleRow.addEventListener("mouseenter", () => {
//   middleRow.style.cursor = "grab";
// });

// middleRow.addEventListener("mouseup", () => {
//   middleRow.style.cursor = "grab";
//   pressed = false;
// });

// middleRow.addEventListener("mousemove", (e) => {
//   if (!pressed) return;
//   e.preventDefault();

//   // for (let i = 0; i < items.length; i++) {
//   // console.log(item.getBoundingClientRect());
//   midPoint = window.innerWidth / 2;

//   for (let item of items) {
//     let itemRect = item.getBoundingClientRect();
//     let itemMidpoint = itemRect.x + itemRect.width / 2;
//     if (itemMidpoint > midPoint - 60 && itemMidpoint < midPoint + 60) {
//       if (
//         item.children[1].tagName == "H1" &&
//         item.children[1].classList.contains("invisible")
//       ) {
//         item.children[1].classList.add("visible");
//         item.children[1].classList.remove("invisible");

//         previousItem.classList.remove("visible");
//         previousItem.classList.add("invisible");
//         previousItem = item.children[1];
//       }
//     }
//   }

//   x = e.offsetX;
//   innerContainer.style.left = `${x - startX}px`;
// });

// let boundItems = () => {
//   let outer = middleRow.getBoundingClientRect();
//   let inner = innerContainer.getBoundingClientRect();

//   if (parseInt(innerContainer.style.left) > 0) {
//     innerContainer.style.left = "0px";
//   }

//   if (inner.right < outer.right) {
//     innerContainer.style.left = `-${inner.width - outer.width}px`;
//   }
// };

// middleRow.addEventListener("mousemove", (e) => {
//   if (!pressed) return;
//   e.preventDefault();

//   x = e.offsetX;
//   innerContainer.style.left = `${x - startX}px`;
//   boundItems();
// }); -->
